library(ggplot2)
library(dplyr)
simulations = 1000
compare <- data.frame(simulations=1:simulations,allyears=NA, surveyeddata=NA, startyear=NA, negwhennot=NA)
for(sims in 1:simulations){
N0 <- runif(1, 1,100)
R <- 3
K <- 500
maxtimesteps = 100
dat <- data.frame(timestep=1:maxtimesteps,popsize=c(N0, rep(NA, 99)))
PopNow <- N0
for(i in 2:nrow(dat)) {
dat[i,"popsize"] <- dat[(i-1),"popsize"] + dat[(i-1),"popsize"]*R*(1-dat[(i-1),"popsize"]/K)
}
allyears <- lm(data=dat, popsize ~ timestep)
compare[sims,"allyears"] <- allyears$coefficients[2]
startdate <- round(runif(1, 1, 80))
compare[sims,"startyear"] <- startdate
surveytimesteps <- seq(startdate, maxtimesteps, by=2)
)
}
library(ggplot2)
library(dplyr)
simulations = 1000
compare <- data.frame(simulations=1:simulations,allyears=NA, surveyeddata=NA, startyear=NA, negwhennot=NA)
N0 <- runif(1, 1,100)
R <- 3
K <- 500
maxtimesteps = 100
dat <- data.frame(timestep=1:maxtimesteps,popsize=c(N0, rep(NA, 99)))
PopNow <- N0
for(i in 2:nrow(dat)) {
dat[i,"popsize"] <- dat[(i-1),"popsize"] + dat[(i-1),"popsize"]*R*(1-dat[(i-1),"popsize"]/K)
}
allyears <- lm(data=dat, popsize ~ timestep)
compare[sims,"allyears"] <- allyears$coefficients[2]
startdate <- round(runif(1, 1, 80))
compare[sims,"startyear"] <- startdate
surveytimesteps <- seq(startdate, maxtimesteps, by=2)
surveyed_data <- dat[surveytimesteps,]
head(surveyed_data)
?rpois
surveyed_data$popsize <- rpois(1, surveyed_data$popsize)
head(surveyed_data)
rpois(1, surveyed_data$popsize)
surveyed_data <- dat[surveytimesteps,]
surveyed_data
?rnorm
surveyed_data$popsize <- rnorm(1, mean=surveyed_data$popsize, sd=0.2*surveyed_data$popsize)
head(surveyed_data)
surveyed_data <- dat[surveytimesteps,]
?apply
surveyed_data$obspopsize <- apply(surveyed_data$popsize, 1, function(x)rnorm(1, mean=x, sd=0.2*x) )
surveyed_data$obspopsize <- apply(surveyed_data$popsize, 1, function(x)rnorm(1, mean=x, sd=0.2*x) )
surveyed_data$popsize <- rnorm(1, mean=surveyed_data$popsize, sd=0.2*surveyed_data$popsize)
x <- cbind(x1 = 3, x2 = c(4:1, 2:5))
x
apply(x, 2, mean, trim = .2)
apply(x, 1, mean, trim = .2)
surveyed_data$obspopsize <- apply(surveyed_data, 1, function(popsize)rnorm(1, mean=popsize, sd=0.2*popsize) )
head(surveyed_data)
surveyed_data <- dat[surveytimesteps,]
surveyed_data$obspopsize <- apply(surveyed_data, 1, function(popsize)rnorm(1, mean=popsize, sd=0.2*popsize) )
head(surveyed_data)
plot(surveyed_data$popsize, surveyed_data$obspopsize)
for(row in 1:nrow(surveyed_data)){
surveyed_data[row,"obspopsize"] <- rnorm(1, mean=surveyed_data[row,"popsize"], sd=0.2*surveyed_data[row,"popsize"])
}
head(surveyed_data)
plot(surveyed_data$popsize, surveyed_data$obspopsize)
ggplot(data=surveyed_data, aes(x=timestep, y=obspopsize))+geom_line()
head(surveyed_data)
sdat <- surveyed_data %>% gather(id="timestep")
sdat <- surveyed_data %>% gather(id="timestep")
library(tidyr)
sdat <- surveyed_data %>% gather(id="timestep")
?gather
sdat <- surveyed_data %>% gather("poptype","popsize",-timestep)
head(sdat)
ggplot(data=sdat, aes(x=timestep, y=popsize, color=poptype))+geom_line()
